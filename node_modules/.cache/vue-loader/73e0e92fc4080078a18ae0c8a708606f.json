{"remainingRequest":"D:\\hbuilderWorkspace\\my-project\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\hbuilderWorkspace\\my-project\\node_modules\\@dcloudio\\vue-cli-plugin-uni\\packages\\webpack-scoped-loader\\index.js!D:\\hbuilderWorkspace\\my-project\\src\\pages\\login\\login.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\hbuilderWorkspace\\my-project\\src\\pages\\login\\login.vue","mtime":1546423103831},{"path":"D:\\hbuilderWorkspace\\my-project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\hbuilderWorkspace\\my-project\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\hbuilderWorkspace\\my-project\\node_modules\\@dcloudio\\vue-cli-plugin-uni\\packages\\webpack-preprocess-loader\\index.js","mtime":499162500000},{"path":"D:\\hbuilderWorkspace\\my-project\\node_modules\\@dcloudio\\vue-cli-plugin-uni\\packages\\webpack-preprocess-loader\\index.js","mtime":499162500000},{"path":"D:\\hbuilderWorkspace\\my-project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\hbuilderWorkspace\\my-project\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\hbuilderWorkspace\\my-project\\node_modules\\@dcloudio\\vue-cli-plugin-uni\\packages\\webpack-scoped-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport service from '../../service.js';\nimport {\n    mapState,\n    mapMutations\n} from 'vuex'\nimport mInput from '../../components/m-input.vue'\n\nexport default {\n    components: {\n        mInput\n    },\n    data() {\n        return {\n            providerList: [],\n            hasProvider: false,\n            account: '',\n            password: '',\n            positionTop: 0\n        }\n    },\n    computed: mapState(['forcedLogin']),\n    methods: {\n        ...mapMutations(['login']),\n        initProvider() {\n            const filters = ['weixin', 'qq', 'sinaweibo'];\n            uni.getProvider({\n                service: 'oauth',\n                success: (res) => {\n                    if (res.provider && res.provider.length) {\n                        for (let i = 0; i < res.provider.length; i++) {\n                            if (~filters.indexOf(res.provider[i])) {\n                                this.providerList.push({\n                                    value: res.provider[i],\n                                    image: '../../static/img/' + res.provider[i] + '.png'\n                                });\n                            }\n                        }\n                        this.hasProvider = true;\n                    }\n                },\n                fail: (err) => {\n                    console.error('获取服务供应商失败：' + JSON.stringify(err));\n                }\n            });\n        },\n        initPosition() {\n            /**\n             * 使用 absolute 定位，并且设置 bottom 值进行定位。软键盘弹出时，底部会因为窗口变化而被顶上来。\n             * 反向使用 top 进行定位，可以避免此问题。\n             */\n            this.positionTop = uni.getSystemInfoSync().windowHeight - 100;\n        },\n        bindLogin() {\n            /**\n             * 客户端对账号信息进行一些必要的校验。\n             * 实际开发中，根据业务需要进行处理，这里仅做示例。\n             */\n            if (this.account.length < 5) {\n                uni.showToast({\n                    icon: 'none',\n                    title: '账号最短为 5 个字符'\n                });\n                return;\n            }\n            if (this.password.length < 6) {\n                uni.showToast({\n                    icon: 'none',\n                    title: '密码最短为 6 个字符'\n                });\n                return;\n            }\n            /**\n             * 下面简单模拟下服务端的处理\n             * 检测用户账号密码是否在已注册的用户列表中\n             * 实际开发中，使用 uni.request 将账号信息发送至服务端，客户端在回调函数中获取结果信息。\n             */\n            const data = {\n                account: this.account,\n                password: this.password\n            };\n            const validUser = service.getUsers().some(function (user) {\n                return data.account === user.account && data.password === user.password;\n            });\n            if (true) {\n                this.toMain(this.account);\n            } else {\n                uni.showToast({\n                    icon: 'none',\n                    title: '用户账号或密码不正确',\n                });\n            }\n        },\n        oauth(value) {\n            uni.login({\n                provider: value,\n                success: (res) => {\n                    uni.getUserInfo({\n                        provider: value,\n                        success: (infoRes) => {\n                            /**\n                             * 实际开发中，获取用户信息后，需要将信息上报至服务端。\n                             * 服务端可以用 userInfo.openId 作为用户的唯一标识新增或绑定用户信息。\n                             */\n                            this.toMain(infoRes.userInfo.nickName);\n                        }\n                    });\n                },\n                fail: (err) => {\n                    console.error('授权登录失败：' + JSON.stringify(err));\n                }\n            });\n        },\n        toMain(userName) {\n            this.login(userName);\n            /**\n             * 强制登录时使用reLaunch方式跳转过来\n             * 返回首页也使用reLaunch方式\n             */\n            if (this.forcedLogin) {\n                uni.reLaunch({\n                    url: '../main/main',\n                });\n            } else {\n                uni.navigateBack();\n            }\n\n        }\n    },\n    onLoad() {\n        this.initPosition();\n        this.initProvider();\n    }\n}\n",{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src\\pages\\login","sourcesContent":["<template>\r\n    <view class=\"content\">\r\n        <mu-form>\r\n            <mu-flex class=\"flex-demo\" justify-content=\"center\" >\r\n\r\n            <mu-text-field v-model=\"account\" label=\"账号\" label-float help-text=\"用户名为6-12长度的字符\"\r\n                           icon=\"account_circle\"></mu-text-field>\r\n            </mu-flex>\r\n\r\n            <br/>\r\n            <mu-flex class=\"flex-demo\" justify-content=\"center\" >\r\n\r\n            <mu-text-field v-model=\"password\" label=\"密码\" label-float help-text=\"密码为6-12长度的字符\" icon=\"locked\"></mu-text-field>\r\n            <br/>\r\n            </mu-flex>\r\n\r\n            <!--<mu-form-item align=\"center\">-->\r\n            <!--</mu-form-item>-->\r\n            <mu-flex class=\"flex-demo\" justify-content=\"center\" >\r\n\r\n            <mu-button color=\"primary\" align=\"center\" @tap=\"bindLogin\" @click=\"bindLogin\">登陆</mu-button>\r\n\r\n                </mu-flex>\r\n        </mu-form>\r\n\r\n        <!--<view class=\"input-group\">-->\r\n            <!--<view class=\"input-row border\">-->\r\n                <!--<text class=\"title\">账号：</text>-->\r\n                <!--<m-input class=\"m-input\" type=\"text\" clearable focus v-model=\"account\" placeholder=\"请输入账号\"></m-input>-->\r\n            <!--</view>-->\r\n            <!--<view class=\"input-row\">-->\r\n                <!--<text class=\"title\">密码：</text>-->\r\n                <!--<m-input type=\"password\" displayable v-model=\"password\" placeholder=\"请输入密码\"></m-input>-->\r\n            <!--</view>-->\r\n        <!--</view>-->\r\n        <!--<view class=\"btn-row\">-->\r\n            <!--<button type=\"primary\" class=\"primary\" @tap=\"bindLogin\">登录</button>-->\r\n        <!--</view>-->\r\n        <!--<view class=\"action-row\">-->\r\n            <!--<navigator url=\"../reg/reg\">注册账号</navigator>-->\r\n            <!--<text>|</text>-->\r\n            <!--<navigator url=\"../pwd/pwd\">忘记密码</navigator>-->\r\n        <!--</view>-->\r\n        <!--<view class=\"oauth-row\" v-if=\"hasProvider\" v-bind:style=\"{top: positionTop + 'px'}\">-->\r\n            <!--<view class=\"oauth-image\" v-for=\"provider in providerList\" :key=\"provider.value\">-->\r\n                <!--<image :src=\"provider.image\" @tap=\"oauth(provider.value)\"></image>-->\r\n            <!--</view>-->\r\n        <!--</view>-->\r\n    </view>\r\n</template>\r\n\r\n<script>\r\n    import service from '../../service.js';\r\n    import {\r\n        mapState,\r\n        mapMutations\r\n    } from 'vuex'\r\n    import mInput from '../../components/m-input.vue'\r\n\r\n    export default {\r\n        components: {\r\n            mInput\r\n        },\r\n        data() {\r\n            return {\r\n                providerList: [],\r\n                hasProvider: false,\r\n                account: '',\r\n                password: '',\r\n                positionTop: 0\r\n            }\r\n        },\r\n        computed: mapState(['forcedLogin']),\r\n        methods: {\r\n            ...mapMutations(['login']),\r\n            initProvider() {\r\n                const filters = ['weixin', 'qq', 'sinaweibo'];\r\n                uni.getProvider({\r\n                    service: 'oauth',\r\n                    success: (res) => {\r\n                        if (res.provider && res.provider.length) {\r\n                            for (let i = 0; i < res.provider.length; i++) {\r\n                                if (~filters.indexOf(res.provider[i])) {\r\n                                    this.providerList.push({\r\n                                        value: res.provider[i],\r\n                                        image: '../../static/img/' + res.provider[i] + '.png'\r\n                                    });\r\n                                }\r\n                            }\r\n                            this.hasProvider = true;\r\n                        }\r\n                    },\r\n                    fail: (err) => {\r\n                        console.error('获取服务供应商失败：' + JSON.stringify(err));\r\n                    }\r\n                });\r\n            },\r\n            initPosition() {\r\n                /**\r\n                 * 使用 absolute 定位，并且设置 bottom 值进行定位。软键盘弹出时，底部会因为窗口变化而被顶上来。\r\n                 * 反向使用 top 进行定位，可以避免此问题。\r\n                 */\r\n                this.positionTop = uni.getSystemInfoSync().windowHeight - 100;\r\n            },\r\n            bindLogin() {\r\n                /**\r\n                 * 客户端对账号信息进行一些必要的校验。\r\n                 * 实际开发中，根据业务需要进行处理，这里仅做示例。\r\n                 */\r\n                if (this.account.length < 5) {\r\n                    uni.showToast({\r\n                        icon: 'none',\r\n                        title: '账号最短为 5 个字符'\r\n                    });\r\n                    return;\r\n                }\r\n                if (this.password.length < 6) {\r\n                    uni.showToast({\r\n                        icon: 'none',\r\n                        title: '密码最短为 6 个字符'\r\n                    });\r\n                    return;\r\n                }\r\n                /**\r\n                 * 下面简单模拟下服务端的处理\r\n                 * 检测用户账号密码是否在已注册的用户列表中\r\n                 * 实际开发中，使用 uni.request 将账号信息发送至服务端，客户端在回调函数中获取结果信息。\r\n                 */\r\n                const data = {\r\n                    account: this.account,\r\n                    password: this.password\r\n                };\r\n                const validUser = service.getUsers().some(function (user) {\r\n                    return data.account === user.account && data.password === user.password;\r\n                });\r\n                if (true) {\r\n                    this.toMain(this.account);\r\n                } else {\r\n                    uni.showToast({\r\n                        icon: 'none',\r\n                        title: '用户账号或密码不正确',\r\n                    });\r\n                }\r\n            },\r\n            oauth(value) {\r\n                uni.login({\r\n                    provider: value,\r\n                    success: (res) => {\r\n                        uni.getUserInfo({\r\n                            provider: value,\r\n                            success: (infoRes) => {\r\n                                /**\r\n                                 * 实际开发中，获取用户信息后，需要将信息上报至服务端。\r\n                                 * 服务端可以用 userInfo.openId 作为用户的唯一标识新增或绑定用户信息。\r\n                                 */\r\n                                this.toMain(infoRes.userInfo.nickName);\r\n                            }\r\n                        });\r\n                    },\r\n                    fail: (err) => {\r\n                        console.error('授权登录失败：' + JSON.stringify(err));\r\n                    }\r\n                });\r\n            },\r\n            toMain(userName) {\r\n                this.login(userName);\r\n                /**\r\n                 * 强制登录时使用reLaunch方式跳转过来\r\n                 * 返回首页也使用reLaunch方式\r\n                 */\r\n                if (this.forcedLogin) {\r\n                    uni.reLaunch({\r\n                        url: '../main/main',\r\n                    });\r\n                } else {\r\n                    uni.navigateBack();\r\n                }\r\n\r\n            }\r\n        },\r\n        onLoad() {\r\n            this.initPosition();\r\n            this.initProvider();\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .action-row {\r\n        display: flex;\r\n        flex-direction: row;\r\n        justify-content: center;\r\n    }\r\n\r\n    .action-row navigator {\r\n        color: #007aff;\r\n        padding: 0 20upx;\r\n    }\r\n\r\n    .oauth-row {\r\n        display: flex;\r\n        flex-direction: row;\r\n        justify-content: center;\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n    }\r\n\r\n    .oauth-image {\r\n        width: 100upx;\r\n        height: 100upx;\r\n        border: 1upx solid #dddddd;\r\n        border-radius: 100upx;\r\n        margin: 0 40upx;\r\n        background-color: #ffffff;\r\n    }\r\n\r\n    .oauth-image image {\r\n        width: 60upx;\r\n        height: 60upx;\r\n        margin: 20upx;\r\n    }\r\n</style>\r\n"]}]}